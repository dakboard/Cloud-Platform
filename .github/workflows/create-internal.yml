name: Create Internal Issue

on:
  issues:
    types: [opened]

jobs:
  create_internal:
    runs-on: ubuntu-latest

    steps:
      - name: Create linked issue in dakboard/Internal
        id: internal
        uses: peter-evans/create-issue@v5
        with:
          token: ${{ secrets.REPO_TOKEN }}
          repository: dakboard/Internal
          title: "CP#${{ github.event.issue.number }} — ${{ github.event.issue.title }}"
          body: |
            A customer reported the following in the PUBLIC repo:

            ---
            ${{ github.event.issue.body }}

            Public Issue URL: ${{ github.event.issue.html_url }}

      - name: Comment backlink to internal
        uses: peter-evans/create-or-update-comment@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          issue-number: ${{ github.event.issue.number }}
          body: |
            Thanks! We’ve created an internal tracking issue:
            https://github.com/dakboard/Internal/issues/${{ steps.internal.outputs.issue-number }}
